<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPV Calculator - Developer & Financial Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/lucide@latest/dist/umd/lucide.js">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="/utils/calculatorUtils.js"></script>
    <script src="/components/calculatorComponents.js"></script>
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">
    
<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="bg-white border-b">
        <div class="container mx-auto px-4 py-6 max-w-7xl">
            <div class="flex items-center gap-4">
                <a href="../index.html" class="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors">
                    <i data-lucide="arrow-left" class="h-4 w-4"></i>
                    Back to Tools
                </a>
                <div class="h-6 w-px bg-gray-300"></div>

            </div>
        </div>
    </div>

                <div class="text-center py-8">
                    <div class="flex items-center justify-center mb-4">
                        <div class="p-4 bg-blue-100 rounded-full">
                            <i data-lucide="bar-chart-3" class="h-8 w-8 text-blue-600"></i>
                        </div>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-900">NPV Calculator</h1>
                    <p class="text-gray-600">Calculate Net Present Value for investment analysis.</p>
                </div>

    <!-- Tool Content -->
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPV Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/lucide@latest/dist/umd/lucide.js">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="/utils/calculatorUtils.js"></script>
    <script src="/components/calculatorComponents.js"></script>
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">
    
<div class="max-w-6xl mx-auto">
  <div class="bg-white rounded-lg shadow-lg p-6">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">NPV Calculator</h1>
    <p class="text-gray-600 mb-8">Calculate Net Present Value (NPV) to evaluate the profitability of investments and projects.</p>
    
    <div class="grid lg:grid-cols-3 gap-8">
      <div class="lg:col-span-1 space-y-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Initial Investment ($)</label>
          <input type="number" id="initialInvestment" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="100000" step="1000">
          <p class="text-xs text-gray-500 mt-1">Upfront cost (negative cash flow)</p>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Discount Rate (%)</label>
          <input type="number" id="discountRate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="10" step="0.1">
          <p class="text-xs text-gray-500 mt-1">Required rate of return or WACC</p>
        </div>
        
        <button onclick="calculateNPV()" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">
          Calculate NPV
        </button>
        
        <div class="bg-blue-50 rounded-lg p-4">
          <h4 class="font-semibold text-blue-800 mb-2">NPV Formula</h4>
          <p class="text-blue-700 text-sm">NPV = Σ [CFt ÷ (1+r)^t] - Initial Investment</p>
          <p class="text-blue-600 text-xs mt-1">Where CFt = Cash Flow at time t, r = discount rate</p>
        </div>
      </div>
      
      <div class="lg:col-span-2">
        <div class="bg-gray-50 rounded-lg p-6 mb-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Cash Flow Projections</h3>
          
          <div class="space-y-3">
            <div class="grid grid-cols-4 gap-2 text-sm font-medium text-gray-700">
              <span>Year</span>
              <span>Cash Flow ($)</span>
              <span>Present Value</span>
              <span>Cumulative PV</span>
            </div>
            <div id="cashFlowInputs" class="space-y-2">
              <!-- Cash flow inputs will be generated here -->
            </div>
            <button onclick="addCashFlowYear()" class="text-blue-600 hover:text-blue-800 text-sm">+ Add Year</button>
          </div>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6">
          <div class="bg-white border rounded-lg p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">NPV Results</h3>
            <div class="space-y-3">
              <div class="flex justify-between">
                <span class="text-gray-600">Net Present Value:</span>
                <span id="npvResult" class="font-bold text-xl text-blue-600">$0</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Total PV of Cash Flows:</span>
                <span id="totalPV" class="font-semibold">$0</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Initial Investment:</span>
                <span id="displayInvestment" class="font-semibold text-red-600">-$0</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Profitability Index:</span>
                <span id="profitabilityIndex" class="font-semibold">0</span>
              </div>
            </div>
          </div>
          
          <div id="npvDecision" class="rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">Investment Decision</h3>
            <div id="decisionContent">
              <p id="decisionText" class="text-sm mb-3"></p>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span>Payback Period:</span>
                  <span id="paybackPeriod" class="font-semibold">- years</span>
                </div>
                <div class="flex justify-between">
                  <span>Break-even Rate:</span>
                  <span id="breakEvenRate" class="font-semibold">-%</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sensitivity Analysis -->
    <div class="mt-8 bg-green-50 rounded-lg p-6">
      <h3 class="text-lg font-semibold text-green-800 mb-4">Sensitivity Analysis</h3>
      <p class="text-green-600 text-sm mb-4">See how NPV changes with different discount rates</p>
      
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b">
              <th class="text-left py-2">Discount Rate</th>
              <th class="text-right py-2">NPV</th>
              <th class="text-right py-2">Decision</th>
              <th class="text-right py-2">PI</th>
            </tr>
          </thead>
          <tbody id="sensitivityTable">
            <!-- Sensitivity analysis will be populated here -->
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="mt-8 bg-gray-50 rounded-lg p-6">
      <h3 class="text-lg font-semibold text-gray-800 mb-3">NPV Decision Rules</h3>
      <div class="grid md:grid-cols-3 gap-6 text-sm text-gray-700">
        <div>
          <h4 class="font-semibold mb-2 text-green-800">Accept Project:</h4>
          <ul class="space-y-1">
            <li>• NPV > 0</li>
            <li>• PI > 1.0</li>
            <li>• Creates shareholder value</li>
            <li>• Returns exceed required rate</li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold mb-2 text-red-800">Reject Project:</h4>
          <ul class="space-y-1">
            <li>• NPV < 0</li>
            <li>• PI < 1.0</li>
            <li>• Destroys shareholder value</li>
            <li>• Returns below required rate</li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold mb-2 text-gray-800">Indifferent:</h4>
          <ul class="space-y-1">
            <li>• NPV = 0</li>
            <li>• PI = 1.0</li>
            <li>• Exactly meets required return</li>
            <li>• No value creation/destruction</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
let cashFlowCounter = 0;

function addCashFlowYear() {
  cashFlowCounter++;
  const cashFlowInputs = document.getElementById('cashFlowInputs');
  
  const cashFlowRow = document.createElement('div');
  cashFlowRow.className = 'grid grid-cols-4 gap-2';
  cashFlowRow.id = `cashFlow${cashFlowCounter}`;
  cashFlowRow.innerHTML = `
    <span class="px-2 py-1 text-sm text-gray-600">${cashFlowCounter}</span>
    <input type="number" class="px-2 py-1 border border-gray-300 rounded text-sm" placeholder="25000" step="1000" onchange="calculateNPV()">
    <span class="px-2 py-1 text-sm text-gray-600 cash-flow-pv">$0</span>
    <span class="px-2 py-1 text-sm text-gray-600 cumulative-pv">$0</span>
  `;
  
  cashFlowInputs.appendChild(cashFlowRow);
  calculateNPV();
}

function calculateNPV() {
  const initialInvestment = parseFloat(document.getElementById('initialInvestment').value) || 0;
  const discountRate = parseFloat(document.getElementById('discountRate').value) || 0;
  
  if (initialInvestment <= 0 || discountRate <= 0) {
    return;
  }
  
  const rate = discountRate / 100;
  let totalPV = 0;
  let cumulativePV = 0;
  let paybackPeriod = null;
  
  const cashFlowRows = document.querySelectorAll('[id^="cashFlow"]');
  cashFlowRows.forEach((row, index) => {
    const input = row.querySelector('input');
    const cashFlow = parseFloat(input.value) || 0;
    const year = index + 1;
    
    if (cashFlow > 0) {
      const pv = cashFlow / Math.pow(1 + rate, year);
      cumulativePV += pv;
      totalPV += pv;
      
      // Update display
      const pvSpan = row.querySelector('.cash-flow-pv');
      const cumulativeSpan = row.querySelector('.cumulative-pv');
      pvSpan.textContent = `$${pv.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
      cumulativeSpan.textContent = `$${cumulativePV.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
      
      // Calculate payback period
      if (paybackPeriod === null && cumulativePV >= initialInvestment) {
        paybackPeriod = year;
      }
    }
  });
  
  const npv = totalPV - initialInvestment;
  const profitabilityIndex = totalPV / initialInvestment;
  
  // Display results
  document.getElementById('npvResult').textContent = `$${npv.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
  document.getElementById('totalPV').textContent = `$${totalPV.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
  document.getElementById('displayInvestment').textContent = `-$${initialInvestment.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
  document.getElementById('profitabilityIndex').textContent = profitabilityIndex.toFixed(2);
  document.getElementById('paybackPeriod').textContent = paybackPeriod ? `${paybackPeriod} years` : 'Never';
  
  // Update NPV color
  const npvElement = document.getElementById('npvResult');
  if (npv > 0) {
    npvElement.className = 'font-bold text-xl text-green-600';
  } else if (npv < 0) {
    npvElement.className = 'font-bold text-xl text-red-600';
  } else {
    npvElement.className = 'font-bold text-xl text-gray-600';
  }
  
  // Update decision
  updateInvestmentDecision(npv, profitabilityIndex);
  
  // Calculate break-even rate (IRR approximation)
  const breakEvenRate = calculateBreakEvenRate(initialInvestment, getCashFlows());
  document.getElementById('breakEvenRate').textContent = `${breakEvenRate.toFixed(1)}%`;
  
  // Generate sensitivity analysis
  generateSensitivityAnalysis(initialInvestment, getCashFlows());
}

function getCashFlows() {
  const cashFlows = [];
  const cashFlowRows = document.querySelectorAll('[id^="cashFlow"]');
  cashFlowRows.forEach(row => {
    const input = row.querySelector('input');
    const cashFlow = parseFloat(input.value) || 0;
    if (cashFlow > 0) {
      cashFlows.push(cashFlow);
    }
  });
  return cashFlows;
}

function calculateBreakEvenRate(investment, cashFlows) {
  // Simple IRR approximation using binary search
  let low = 0, high = 100;
  let iterations = 0;
  
  while (high - low > 0.01 && iterations < 100) {
    const mid = (low + high) / 2;
    const rate = mid / 100;
    
    let npv = -investment;
    cashFlows.forEach((cf, index) => {
      npv += cf / Math.pow(1 + rate, index + 1);
    });
    
    if (npv > 0) {
      low = mid;
    } else {
      high = mid;
    }
    iterations++;
  }
  
  return (low + high) / 2;
}

function updateInvestmentDecision(npv, pi) {
  const decisionDiv = document.getElementById('npvDecision');
  const decisionText = document.getElementById('decisionText');
  
  let bgClass, textClass, decision;
  
  if (npv > 50000) {
    bgClass = 'bg-green-50 border border-green-200';
    textClass = 'text-green-800';
    decision = 'STRONG ACCEPT: Excellent NPV indicates this project will create significant shareholder value. Highly recommended investment.';
  } else if (npv > 0) {
    bgClass = 'bg-green-50 border border-green-200';
    textClass = 'text-green-800';
    decision = 'ACCEPT: Positive NPV indicates this project will create value. The investment should be undertaken.';
  } else if (npv > -10000) {
    bgClass = 'bg-yellow-50 border border-yellow-200';
    textClass = 'text-yellow-800';
    decision = 'MARGINAL: NPV is close to zero. Consider other factors and alternative investments before deciding.';
  } else {
    bgClass = 'bg-red-50 border border-red-200';
    textClass = 'text-red-800';
    decision = 'REJECT: Negative NPV indicates this project will destroy value. The investment should not be undertaken.';
  }
  
  decisionDiv.className = `rounded-lg p-6 ${bgClass}`;
  decisionText.className = `text-sm mb-3 ${textClass}`;
  decisionText.textContent = decision;
}

function generateSensitivityAnalysis(investment, cashFlows) {
  const sensitivityTable = document.getElementById('sensitivityTable');
  sensitivityTable.innerHTML = '';
  
  const rates = [5, 7.5, 10, 12.5, 15, 17.5, 20];
  
  rates.forEach(discountRate => {
    const rate = discountRate / 100;
    let totalPV = 0;
    
    cashFlows.forEach((cf, index) => {
      totalPV += cf / Math.pow(1 + rate, index + 1);
    });
    
    const npv = totalPV - investment;
    const pi = totalPV / investment;
    const decision = npv > 0 ? 'Accept' : npv < 0 ? 'Reject' : 'Indifferent';
    const decisionClass = npv > 0 ? 'text-green-600' : npv < 0 ? 'text-red-600' : 'text-gray-600';
    
    const row = sensitivityTable.insertRow();
    row.innerHTML = `
      <td class="py-2">${discountRate}%</td>
      <td class="text-right py-2">$${npv.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td>
      <td class="text-right py-2 ${decisionClass}">${decision}</td>
      <td class="text-right py-2">${pi.toFixed(2)}</td>
    `;
  });
}

// Initialize with 5 cash flow years
document.addEventListener('DOMContentLoaded', function() {
  for (let i = 0; i < 5; i++) {
    addCashFlowYear();
  }
  
  // Auto-calculate on input change
  const inputs = ['initialInvestment', 'discountRate'];
  inputs.forEach(id => {
    document.getElementById(id).addEventListener('input', calculateNPV);
  });
});
</script>

    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>
    </div>
</div>

    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>